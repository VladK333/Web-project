<!DOCTYPE html>
<html lang="sr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../Content/tailwind.css" rel="stylesheet">
    <script src="../Scripts/jquery-3.7.1.min.js"></script>
    <title>Registracija - Turistička agencija</title>
    <script>
        // Proveri da li je vec prijavljen korisnik
        $.ajax({
            url: 'http://localhost:51858/api/identity/sesija',
            type: 'GET',
            success: function (response) {
                if (response && response.data) {
                    window.location.href = "Profil.html";
                }
            }
        });

        $(document).ready(function () {
            $('#navigation-menu').load('NavigacioniMeni.html', function (response, status, xhr) {
                if (status === 'error') {
                    console.error('Greška pri učitavanju menija:', xhr.status, xhr.statusText);
                }
            });

            $('#registrationForm').submit(function (event) {
                event.preventDefault();

                var korisnickoIme = $('#username').val();
                var lozinka = $('#password').val();
                var ime = $('#ime').val();
                var prezime = $('#prezime').val();
                var email = $('#email').val();
                var datumRodjenja = $('#datumRodjenja').val();
                var pol = $('#pol').val();

                $.ajax({
                    url: 'http://localhost:51858/api/identity/registracija',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        KorisnickoIme: korisnickoIme,
                        Lozinka: lozinka,
                        Ime: ime,
                        Prezime: prezime,
                        Email: email,
                        DatumRodjenja: datumRodjenja,
                        Pol: pol
                    }),
                    success: function () {
                        window.location.href = "Profil.html";
                    },
                    error: function () {
                        $('#greska').text("Proverite unete podatke!");
                    }
                });
            });
        });
    </script>
</head>

<body class="bg-gray-50">
    <div id="navigation-menu" class="w-full -mb-8"></div>
    <section class="relative flex flex-wrap lg:h-screen lg:items-center">
        <div class="w-full px-6 py-12 sm:px-8 sm:py-16 lg:w-1/2 lg:px-12 lg:py-20">
            <div class="mx-auto max-w-lg text-center">
                <h1 class="text-3xl font-extrabold text-blue-600 sm:text-4xl">Registracija naloga</h1>

                <p class="mt-4 text-gray-600">
                    Kreirajte svoj nalog i otkrijte ekskluzivne turističke aranžmane,
                    jednostavne rezervacije i personalizovane preporuke destinacija.
                </p>
            </div>

            <form id="registrationForm" class="mx-auto mb-0 mt-10 max-w-md space-y-6 bg-white rounded-xl shadow-lg p-6">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Korisničko ime</label>
                    <input type="text" id="username"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none"
                           placeholder="Unesite korisničko ime" />
                </div>

                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Lozinka</label>
                    <input type="password" id="password"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none"
                           placeholder="Unesite lozinku" />
                </div>

                <div>
                    <label for="ime" class="block text-sm font-medium text-gray-700 mb-1">Ime</label>
                    <input type="text" id="ime"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none"
                           placeholder="Unesite ime" />
                </div>

                <div>
                    <label for="prezime" class="block text-sm font-medium text-gray-700 mb-1">Prezime</label>
                    <input type="text" id="prezime"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none"
                           placeholder="Unesite prezime" />
                </div>

                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="email"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none"
                           placeholder="Unesite email" />
                </div>

                <div>
                    <label for="datumRodjenja" class="block text-sm font-medium text-gray-700 mb-1">Datum rođenja</label>
                    <input type="date" id="datumRodjenja"
                           class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none" />
                </div>

                <div>
                    <label for="pol" class="block text-sm font-medium text-gray-700 mb-1">Pol</label>
                    <select id="pol"
                            class="w-full rounded-lg border-gray-300 p-3 text-sm shadow-sm border focus:border-blue-600 outline-none">
                        <option value="Muski">Muški</option>
                        <option value="Zenski">Ženski</option>
                        <option value="Drugo">Drugo</option>
                    </select>
                </div>

                <p class="text-red-500 text-center" id="greska"></p>

                <div class="flex items-center justify-between">
                    <p class="text-sm text-gray-600">
                        Već imate nalog?
                        <a class="hover:text-blue-600 font-medium" href="Prijava.html">Prijavite se</a>
                    </p>

                    <button type="submit"
                            class="inline-block rounded-lg bg-blue-500 px-5 py-2 text-sm font-semibold text-white shadow-md hover:bg-blue-600 transition">
                        Registrujte se
                    </button>
                </div>
            </form>
        </div>
        
        <div class="relative hidden lg:block lg:w-1/2 h-full pr-12">
        <img alt="Putovanja" src="images/login.jpg"
             class="relative rounded-xl inset-0 h-full w-full object-cover shadow-lg" />
        </div>

    </section>
</body>

</html>
